<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Verification - SwapMyStuff</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f4f4f4;
            text-align: center;
        }
        .container {
            max-width: 600px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #333;
        }
        p {
            color: #666;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Email Verification</h1>
        <p>Processing your email verification...</p>
    </div>
    <script>
        const params = new URLSearchParams(window.location.search);
        const token = params.get('token');
        const type = params.get('type');
        const state = params.get('state');
        const email = params.get('email');

        if (token && type && state) {
            const deepLink = `com.swapmystuff20://auth/confirm?token=${token}&type=${type}&state=${state}${email ? `&email=${email}` : ''}`;
            window.location.href = deepLink;
            setTimeout(() => {
                document.querySelector('.container').innerHTML = `
                    <h1>Email Verification</h1>
                    <p>It looks like the SwapMyStuff app is not installed or the link couldn't be opened. Please open the SwapMyStuff app on the device where you registered and use the "Verify Now" button to complete verification, or install the app and try again.</p>
                `;
            }, 1000);
        } else {
            document.querySelector('.container').innerHTML = `
                <h1>Invalid Verification Link</h1>
                <p>The verification link is invalid or missing required parameters (token, type, or state). Please request a new confirmation email from the SwapMyStuff app.</p>
            `;
        }
    </script>
</body>
</html>
